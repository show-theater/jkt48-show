  <!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Detail Member - JKT48 Show Theater</title>

<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Arial,sans-serif;background:#f5f5f5;color:#333;min-height:100vh;padding:20px;transition:background 0.3s,color 0.3s}
body.dark{background:#0a0e1a;color:#e5e7eb}

.back-btn{position:fixed;top:20px;left:20px;background:#fff;border:1px solid #ddd;color:#333;padding:12px 24px;border-radius:50px;font-weight:bold;cursor:pointer;font-size:14px;transition:all 0.3s;text-decoration:none;display:inline-flex;align-items:center;gap:8px;z-index:100}
.back-btn:hover{background:#f5f5f5;transform:translateX(-5px)}
body.dark .back-btn{background:#111827;border-color:#1f2937;color:#e5e7eb}
body.dark .back-btn:hover{background:#1f2937}

.theme-toggle{position:fixed;top:20px;right:20px;background:#e60012;border:none;color:#fff;width:40px;height:40px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;padding:8px;z-index:100;transition:all 0.3s}
.theme-toggle:hover{transform:scale(1.1)}
.theme-toggle svg{width:100%;height:100%;transition:transform 0.3s}

.container{max-width:500px;width:100%;margin:80px auto 40px;background:#fff;border-radius:24px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,0.1);transition:background 0.3s,box-shadow 0.3s}
body.dark .container{background:#111827;box-shadow:0 2px 8px rgba(0,0,0,0.4)}

.header{background:linear-gradient(135deg,var(--gen-color),var(--gen-color-dark));padding:20px;text-align:center;position:relative}
.header h1{font-size:18px;margin:0;color:#fff;font-weight:600}

.photo-container{text-align:center;margin:20px 0}
.photo{width:160px;height:160px;border-radius:50%;border:4px solid #fff;object-fit:cover;box-shadow:0 4px 12px rgba(0,0,0,0.15);background:#f5f5f5}
body.dark .photo{border-color:#1f2937;background:#0a0e1a}

.member-name{text-align:center;font-size:24px;font-weight:bold;color:#333;margin:10px 0 30px}
body.dark .member-name{color:#e5e7eb}

.about-title{font-size:20px;font-weight:bold;color:#333;margin:0 30px 20px}
body.dark .about-title{color:#e5e7eb}

.info-card{background:#f9fafb;border:1px solid #e5e7eb;border-radius:20px;padding:20px;margin:0 30px 20px;transition:background 0.3s,border-color 0.3s}
body.dark .info-card{background:#1f2937;border-color:#374151}

.info-row{display:flex;justify-content:space-between;align-items:flex-start;padding:12px 0;border-bottom:1px solid #e5e7eb}
.info-row:last-child{border-bottom:none}
body.dark .info-row{border-bottom-color:#374151}
.info-label{color:#6b7280;font-size:14px;font-weight:600;flex-shrink:0;width:120px}
body.dark .info-label{color:#9ca3af}
.info-value{color:#333;font-size:14px;font-weight:600;text-align:right;flex:1}
body.dark .info-value{color:#e5e7eb}

.content{padding:0 0 30px}

.milestone-section{margin:0 30px 15px}
.milestone-card{background:#f9fafb;border:1px solid #e5e7eb;border-radius:12px;padding:12px;transition:background 0.3s,border-color 0.3s}
body.dark .milestone-card{background:#1f2937;border-color:#374151}
.milestone-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.milestone-title{font-size:12px;font-weight:600;color:#6b7280}
body.dark .milestone-title{color:#9ca3af}
.milestone-target{font-size:16px;font-weight:bold;transition:color 0.3s}
.milestone-target.normal{color:var(--gen-color)}
.milestone-target.warning{color:#facc15}
.milestone-target.completed{color:#22c55e}
.progress-bar-container{height:18px;background:#e5e7eb;border-radius:9px;overflow:visible;position:relative;margin-bottom:6px}
body.dark .progress-bar-container{background:#374151}
.progress-bar-fill{height:100%;background:var(--gen-color);border-radius:9px;transition:width 1s cubic-bezier(0.4,0,0.2,1);position:relative}
.progress-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:11px;font-weight:600;color:#6b7280;z-index:10}
body.dark .progress-text{color:#9ca3af}
.progress-info{text-align:center;font-size:11px;color:#6b7280;font-weight:500}
body.dark .progress-info{color:#9ca3af}

.social-section{margin:0 30px 15px}
.social-link{display:flex;align-items:center;padding:10px 0;background:transparent;border:none;border-radius:0;margin-bottom:8px;text-decoration:none;transition:all 0.3s}
.social-link:hover{transform:translateX(5px)}
.social-link:last-child{margin-bottom:0}
.social-icon{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0;background:#f9fafb;border:1px solid #e5e7eb;transition:background 0.3s,border-color 0.3s}
body.dark .social-icon{background:#1f2937;border-color:#374151}
.social-icon svg{width:22px;height:22px;color:#333}
body.dark .social-icon svg{color:#e5e7eb}
.social-info{flex:1;margin-left:12px}
.social-name{font-size:13px;font-weight:bold;color:#333;margin-bottom:1px}
body.dark .social-name{color:#e5e7eb}
.social-handle{font-size:12px;color:#6b7280;font-weight:500}
body.dark .social-handle{color:#9ca3af}
.social-arrow{font-size:16px;color:#333;font-weight:bold}
body.dark .social-arrow{color:#e5e7eb}

.loading{text-align:center;padding:100px 20px;color:#6b7280;display:flex;align-items:center;justify-content:center;gap:8px}

@keyframes spin{to{transform:rotate(360deg)}}
.spinner{display:inline-block;width:24px;height:24px;border:3px solid rgba(0,0,0,0.1);border-top-color:#9ca3af;border-radius:50%;animation:spin 0.8s linear infinite}
body.dark .spinner{border-color:rgba(255,255,255,0.1);border-top-color:#9ca3af}

@media (max-width:480px) {
  body{padding:10px}
  .back-btn{top:10px;left:10px;padding:8px 16px;font-size:12px;gap:6px}
  .theme-toggle{top:10px;right:10px;width:36px;height:36px}
  .container{max-width:100%;margin:60px auto 20px;border-radius:16px}
  .header{padding:15px}
  .header h1{font-size:16px}
  .photo{width:130px;height:130px;border-width:3px}
  .member-name{font-size:20px;margin:10px 0 20px}
  .about-title{font-size:18px;margin:0 20px 15px}
  .info-card{padding:15px;margin:0 20px 15px}
  .info-row{padding:10px 0}
  .info-label{font-size:13px;width:100px}
  .info-value{font-size:13px}
  .milestone-section{margin:0 20px 12px}
  .milestone-card{padding:10px}
  .milestone-title{font-size:11px}
  .milestone-target{font-size:15px}
  .progress-bar-container{height:16px}
  .progress-text{font-size:10px}
  .progress-info{font-size:10px}
  .social-section{margin:0 20px 15px}
  .social-icon{width:40px;height:40px}
  .social-icon svg{width:20px;height:20px}
  .social-name{font-size:12px}
  .social-handle{font-size:11px}
}
</style>
</head>
<body>

<button onclick="goBack()" class="back-btn">← Kembali</button>
<button class="theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">
  <svg id="themeIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
    <path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/>
  </svg>
</button>

<div class="container" id="container">
  <div class="loading"><div class="spinner"></div>Loading...</div>
</div>

<script>
const SUPABASE_URL = "https://pprxfopqkvpeajeoxzig.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBwcnhmb3Bxa3ZwZWFqZW94emlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYyNTI4MTIsImV4cCI6MjA4MTgyODgxMn0.iXRO_dAHhtVHRLqGTresG_63RD2zIaopNXtXYNfthdg";

const urlParams = new URLSearchParams(window.location.search);
const MEMBER_NAME = urlParams.get('member');

const db = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

const GEN_COLORS = {
  3: '#ec4899', 6: '#22c55e', 7: '#15803d', 8: '#1e40af',
  9: '#06b6d4', 10: '#38bdf8', 11: '#f97316', 12: '#fde68a',
  13: '#facc15', 14: '#f3c6ff'
};

// Dark mode functionality
function toggleTheme() {
  const body = document.body;
  const icon = document.getElementById('themeIcon');
  body.classList.toggle('dark');
  
  if (body.classList.contains('dark')) {
    icon.innerHTML = '<path d="M12,17a5,5,0,1,1,5-5A5,5,0,0,1,12,17Zm0-8a3,3,0,1,0,3,3A3,3,0,0,0,12,9Zm0-4a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41L6.34,5A1,1,0,0,0,4.93,6.34ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm.64,5.66a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71a1,1,0,0,0-1.41-1.41ZM12,19a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19Zm6.36-2.34a1,1,0,0,0-1.41,1.41l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-3.64-3.95a1,1,0,0,0,.7.29,1,1,0,0,0,.71-1.7l-.71-.71a1,1,0,0,0-1.41,1.41Z"/>';
    localStorage.setItem('jkt48_theme', 'dark');
  } else {
    icon.innerHTML = '<path d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z"/>';
    localStorage.setItem('jkt48_theme', 'light');
  }
}

// Load saved theme
const savedTheme = localStorage.getItem('jkt48_theme');
if (savedTheme === 'dark') {
  document.body.classList.add('dark');
}

async function loadMember() {
  if (!MEMBER_NAME) {
    document.getElementById('container').innerHTML = '<div class="loading">Member tidak ditemukan</div>';
    return;
  }

  try {
    const { data, error } = await db
      .from('members')
      .select('*')
      .eq('name', MEMBER_NAME)
      .single();

    if (error) throw error;
    
    if (!data) {
      document.getElementById('container').innerHTML = '<div class="loading">Member tidak ditemukan</div>';
      return;
    }

    renderMember(data);
    
  } catch (err) {
    console.error('Error:', err);
    document.getElementById('container').innerHTML = '<div class="loading">Error loading data</div>';
  }
}

function renderMember(member) {
  const color = GEN_COLORS[member.gen] || '#ec4899';
  const colorDark = adjustColor(color, -20);
  
  document.documentElement.style.setProperty('--gen-color', color);
  document.documentElement.style.setProperty('--gen-color-dark', colorDark);
  
  const currentShow = member.show || 0;
  const nextMilestone = Math.ceil(currentShow / 100) * 100;
  const remaining = nextMilestone - currentShow;
  const progress = ((currentShow % 100) / 100) * 100;
  
  let statusClass = 'normal';
  if (remaining === 0) {
    statusClass = 'completed';
  } else if (remaining > 0 && remaining <= 10) {
    statusClass = 'warning';
  } else {
    statusClass = 'normal';
  }
  
  document.getElementById('container').innerHTML = `
    <div class="header">
      <h1>Profile Member</h1>
    </div>
    <div class="photo-container">
      <img class="photo" src="img/${member.name.toLowerCase()}.jpg" onerror="this.src='img/default.jpg'" alt="${member.name}">
    </div>
    <div class="member-name">${member.nickname || member.name}</div>
    <div class="content">
      
      <div class="about-title">About</div>
      <div class="info-card">
        <div class="info-row">
          <div class="info-label">Full Name</div>
          <div class="info-value">${member.full_name || member.name}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Birthday</div>
          <div class="info-value">${member.birth_date || '-'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Blood Type</div>
          <div class="info-value">${member.blood_type || '-'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Horoscope</div>
          <div class="info-value">${member.zodiac || '-'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Height</div>
          <div class="info-value">${member.height || '-'}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Generation</div>
          <div class="info-value">Gen ${member.gen}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Nickname</div>
          <div class="info-value">${member.nickname || member.name}</div>
        </div>
      </div>
      
      <div class="milestone-section">
        <div class="milestone-card">
          <div class="milestone-header">
            <div class="milestone-title">Progress Milestone</div>
            <div class="milestone-target ${statusClass}">${nextMilestone} show</div>
          </div>
          <div class="progress-bar-container">
            <div class="progress-bar-fill" style="width:${progress}%"></div>
            <div class="progress-text">${currentShow} show</div>
          </div>
          <div class="progress-info">
            ${remaining === 0 ? 'Target tercapai!' : `${remaining} show lagi untuk mencapai target`}
          </div>
        </div>
      </div>
      
      ${member.twitter || member.instagram ? `
      <div class="social-section">
        ${member.twitter ? `
        <a href="https://twitter.com/${member.twitter}" target="_blank" class="social-link">
          <div class="social-icon twitter">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="22" height="22" fill="currentColor">
              <path d="M357.2 48L427.8 48 273.6 224.2 455 464 313 464 201.7 318.6 74.5 464 3.8 464 168.7 275.5-5.2 48 140.4 48 240.9 180.9 357.2 48zM332.4 421.8l39.1 0-252.4-333.8-42 0 255.3 333.8z"/>
            </svg>
          </div>
          <div class="social-info">
            <div class="social-name">Twitter</div>
            <div class="social-handle">@${member.twitter}</div>
          </div>
          <div class="social-arrow">→</div>
        </a>
        ` : ''}
        
        ${member.instagram ? `
        <a href="https://instagram.com/${member.instagram}" target="_blank" class="social-link">
          <div class="social-icon instagram">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
              <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
              <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
            </svg>
          </div>
          <div class="social-info">
            <div class="social-name">Instagram</div>
            <div class="social-handle">@${member.instagram}</div>
          </div>
          <div class="social-arrow">→</div>
        </a>
        ` : ''}
      </div>
      ` : ''}
    </div>
  `;
}

function adjustColor(color, amount) {
  const num = parseInt(color.replace('#', ''), 16);
  const r = Math.max(0, Math.min(255, (num >> 16) + amount));
  const g = Math.max(0, Math.min(255, ((num >> 8) & 0x00FF) + amount));
  const b = Math.max(0, Math.min(255, (num & 0x0000FF) + amount));
  return '#' + ((r << 16) | (g << 8) | b).toString(16).padStart(6, '0');
}

function goBack() {
  if (window.history.length > 1) {
    window.history.back();
  } else {
    window.location.href = 'index.html';
  }
}

window.addEventListener('DOMContentLoaded', () => {
  const icon = document.getElementById('themeIcon');
  if (savedTheme === 'dark' && icon) {
    icon.innerHTML = '<path d="M12,17a5,5,0,1,1,5-5A5,5,0,0,1,12,17Zm0-8a3,3,0,1,0,3,3A3,3,0,0,0,12,9Zm0-4a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41L6.34,5A1,1,0,0,0,4.93,6.34ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm.64,5.66a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71a1,1,0,0,0-1.41-1.41ZM12,19a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19Zm6.36-2.34a1,1,0,0,0-1.41,1.41l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-3.64-3.95a1,1,0,0,0,.7.29,1,1,0,0,0,.71-1.7l-.71-.71a1,1,0,0,0-1.41,1.41Z"/>';
  }
});

loadMember();
</script>
</body>
</html>