<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Detail Member - JKT48 Show Theater</title>

<!-- ‚úÖ Meta tag untuk mencegah browser caching -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',Arial,sans-serif;background:linear-gradient(135deg,#0f1220,#1a1f3c);color:#fff;min-height:100vh;padding:20px}

/* Back Button - Responsive */
.back-btn{
  position:fixed;
  top:20px;
  left:20px;
  background:rgba(255,255,255,0.1);
  backdrop-filter:blur(10px);
  border:2px solid rgba(255,255,255,0.2);
  color:#fff;
  padding:12px 24px;
  border-radius:50px;
  font-weight:bold;
  cursor:pointer;
  font-size:14px;
  transition:all 0.3s;
  text-decoration:none;
  display:inline-flex;
  align-items:center;
  gap:8px;
  z-index:100;
}
.back-btn:hover{background:rgba(255,255,255,0.2);transform:translateX(-5px)}

/* Container - Responsive Width */
.container{
  max-width:500px;
  width:100%;
  margin:80px auto 40px;
  background:linear-gradient(135deg,#1f2937,#111827);
  border-radius:24px;
  overflow:hidden;
  box-shadow:0 20px 60px rgba(0,0,0,0.5);
}

/* Header */
.header{
  background:linear-gradient(135deg,#ec4899,#8b5cf6);
  padding:20px;
  text-align:center;
  position:relative;
}
.header h1{
  font-size:20px;
  margin:0;
  color:#fff;
  text-shadow:2px 2px 8px rgba(0,0,0,0.3);
}

/* Photo Container */
.photo-container{text-align:center;margin:10px 0 0}
.photo{
  width:140px;
  height:140px;
  border-radius:50%;
  border:5px solid #fff;
  object-fit:cover;
  box-shadow:0 10px 30px rgba(0,0,0,0.5);
  background:#1f2937;
}

/* Content */
.content{padding:30px}
.info-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:16px 0;
  border-bottom:1px solid #374151;
}
.info-row:last-child{border-bottom:none}
.info-label{
  color:#9ca3af;
  font-size:15px;
  font-weight:600;
}
.info-value{
  color:#fff;
  font-size:15px;
  font-weight:bold;
  text-align:right;
  max-width:60%;
  word-wrap:break-word;
}

/* Show Count */
.show-count{
  background:linear-gradient(135deg,#ec4899,#8b5cf6);
  padding:20px;
  margin:20px 0 0;
  border-radius:16px;
  text-align:center;
}
.show-count .number{
  font-size:36px;
  font-weight:bold;
  color:#fff;
  margin-bottom:5px;
}
.show-count .label{
  font-size:14px;
  color:rgba(255,255,255,0.8);
}

/* Loading */
.loading{text-align:center;padding:100px 20px;color:#9ca3af}

/* ========================================
   RESPONSIVE BREAKPOINTS
   ======================================== */

/* Tablet (768px - 1024px) */
@media (max-width: 1024px) and (min-width: 768px) {
  .container{
    max-width:600px;
    margin:90px auto 40px;
  }
  .header h1{font-size:22px}
  .photo{width:160px;height:160px}
  .content{padding:35px}
  .info-label{font-size:16px}
  .info-value{font-size:16px}
  .show-count .number{font-size:42px}
  .show-count .label{font-size:15px}
}

/* Mobile Large (481px - 767px) */
@media (max-width: 767px) and (min-width: 481px) {
  body{padding:15px}
  .back-btn{
    top:15px;
    left:15px;
    padding:10px 20px;
    font-size:13px;
  }
  .container{
    max-width:450px;
    margin:70px auto 30px;
    border-radius:20px;
  }
  .header{padding:18px}
  .header h1{font-size:18px}
  .photo{width:130px;height:130px;border-width:4px}
  .content{padding:25px}
  .info-row{padding:14px 0}
  .info-label{font-size:14px}
  .info-value{font-size:14px}
  .show-count{padding:18px;margin:18px 0 0}
  .show-count .number{font-size:32px}
  .show-count .label{font-size:13px}
}

/* Mobile Small (320px - 480px) */
@media (max-width: 480px) {
  body{padding:10px}
  .back-btn{
    top:10px;
    left:10px;
    padding:8px 16px;
    font-size:12px;
    gap:6px;
  }
  .container{
    max-width:100%;
    margin:60px auto 20px;
    border-radius:16px;
  }
  .header{padding:15px}
  .header h1{font-size:16px}
  .photo{width:110px;height:110px;border-width:3px}
  .content{padding:20px}
  .info-row{
    padding:12px 0;
    flex-direction:row;
    gap:10px;
  }
  .info-label{
    font-size:13px;
    flex-shrink:0;
  }
  .info-value{
    font-size:13px;
    max-width:55%;
  }
  .show-count{
    padding:16px;
    margin:16px 0 0;
    border-radius:12px;
  }
  .show-count .number{font-size:28px}
  .show-count .label{font-size:12px}
}

/* Mobile Extra Small (< 360px) */
@media (max-width: 359px) {
  body{padding:8px}
  .back-btn{padding:6px 12px;font-size:11px}
  .container{margin:55px auto 15px}
  .header{padding:12px}
  .header h1{font-size:14px}
  .photo{width:90px;height:90px}
  .content{padding:15px}
  .info-row{padding:10px 0}
  .info-label{font-size:12px}
  .info-value{font-size:12px}
  .show-count{padding:14px}
  .show-count .number{font-size:24px}
  .show-count .label{font-size:11px}
}

/* Landscape Mode untuk Mobile */
@media (max-height: 500px) and (orientation: landscape) {
  .container{margin:20px auto}
  .photo{width:80px;height:80px}
  .content{padding:15px}
  .info-row{padding:8px 0}
  .show-count{padding:12px;margin:12px 0 0}
  .show-count .number{font-size:24px}
}

/* Desktop Large (> 1024px) */
@media (min-width: 1025px) {
  .container{
    max-width:550px;
    margin:100px auto 50px;
  }
  .photo{width:160px;height:160px}
  .content{padding:35px}
  .info-label{font-size:16px}
  .info-value{font-size:16px}
  .show-count .number{font-size:40px}
}
</style>
</head>
<body>

<button onclick="goBack()" class="back-btn">‚Üê Kembali</button>

<div class="container" id="container">
  <div class="loading">‚è≥ Loading...</div>
</div>

<script>
// ========================================
// CONFIG
// ========================================
const SUPABASE_URL = "https://pprxfopqkvpeajeoxzig.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBwcnhmb3Bxa3ZwZWFqZW94emlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYyNTI4MTIsImV4cCI6MjA4MTgyODgxMn0.iXRO_dAHhtVHRLqGTresG_63RD2zIaopNXtXYNfthdg";

// Get member name from URL parameter
const urlParams = new URLSearchParams(window.location.search);
const MEMBER_NAME = urlParams.get('member');

const db = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

const GEN_COLORS = {
  3: '#ec4899',
  6: '#22c55e',
  7: '#15803d',
  8: '#1e40af',
  9: '#06b6d4',
  10: '#38bdf8',
  11: '#f97316',
  12: '#fde68a',
  13: '#facc15'
};

// ========================================
// LOAD DATA
// ========================================
async function loadMember() {
  if (!MEMBER_NAME) {
    document.getElementById('container').innerHTML = '<div class="loading">‚ùå Member tidak ditemukan</div>';
    return;
  }

  try {
    const { data, error } = await db
      .from('members')
      .select('*')
      .eq('name', MEMBER_NAME)
      .single();

    if (error) throw error;
    
    if (!data) {
      document.getElementById('container').innerHTML = '<div class="loading">‚ùå Member tidak ditemukan</div>';
      return;
    }

    renderMember(data);
    
  } catch (err) {
    console.error('Error:', err);
    document.getElementById('container').innerHTML = '<div class="loading">‚ùå Error loading data</div>';
  }
}

// ========================================
// RENDER
// ========================================
function renderMember(member) {
  const color = GEN_COLORS[member.gen] || '#ec4899';
  
  document.getElementById('container').innerHTML = `
    <div class="header" style="background:linear-gradient(135deg, ${color}, ${color}dd)">
      <h1>Anggota JKT48</h1>
    </div>
    <div class="photo-container">
      <img class="photo" src="img/${member.name.toLowerCase()}.jpg" onerror="this.src='img/default.jpg'" alt="${member.name}">
    </div>
    <div class="content">
      <div class="info-row">
        <div class="info-label">Nama</div>
        <div class="info-value">${member.full_name || member.name}</div>
      </div>
      <div class="info-row">
        <div class="info-label">Tanggal Lahir</div>
        <div class="info-value">${member.birth_date || '-'}</div>
      </div>
      <div class="info-row">
        <div class="info-label">Golongan Darah</div>
        <div class="info-value">${member.blood_type || '-'}</div>
      </div>
      <div class="info-row">
        <div class="info-label">Horoskop</div>
        <div class="info-value">${member.zodiac || '-'}</div>
      </div>
      <div class="info-row">
        <div class="info-label">Tinggi Badan</div>
        <div class="info-value">${member.height || '-'}</div>
      </div>
      <div class="info-row">
        <div class="info-label">Nama Panggilan</div>
        <div class="info-value">${member.nickname || member.name}</div>
      </div>
      <div class="show-count" style="background:linear-gradient(135deg, ${color}, ${color}dd)">
        <div class="number">${member.show}</div>
        <div class="label">Total Show Theater</div>
      </div>
    </div>
  `;
}

// ========================================
// NAVIGATION
// ========================================
function goBack() {
  // Cek apakah ada history sebelumnya
  if (window.history.length > 1) {
    window.history.back();
  } else {
    // Jika tidak ada history, redirect ke index
    window.location.href = 'index.html';
  }
}

// ========================================
// INIT
// ========================================
loadMember();

console.log('üöÄ JKT48 Show Theater - Detail View');
</script>
</body>
</html>